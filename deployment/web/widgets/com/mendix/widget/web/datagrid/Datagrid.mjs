import{createContext as e,useState as t,useRef as n,useEffect as o,useCallback as r,useMemo as i,forwardRef as l,createElement as s,memo as a,useContext as c,Fragment as u,useLayoutEffect as d,Children as p,isValidElement as h,cloneElement as m,useReducer as g}from"react";import{and as f}from"mendix/filters/builders";import"react-dom";var v;!function(e){e.STRING="string",e.NUMBER="number",e.ENUMERATION="enum",e.DATE="date",e.ASSOCIATION="association"}(v||(v={}));const w="com.mendix.widgets.web.filterable.filterContext";function b(){const t=window[w];if(t)return{FilterContext:t};const n=e(void 0);return window[w]=n,{FilterContext:n}}const y=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);function x(e,t){if(function(e){return y(e,"arg1")&&y(e,"arg2")}(e)&&"attribute"===e.arg1.type&&e.arg1.attributeId===t.id&&(n=e.arg2,y(n,"type")&&y(n,"value")))return{type:e.name,value:e.arg2.value};var n}function C(e,t){var n;if(!e||!t)return[];return(null!==(n=S(t))&&void 0!==n?n:[]).flatMap((t=>{const n=x(t,e);return n?[n]:[]}))}function S(e){return!e||"function"!==e.type||"and"!==e.name&&"or"!==e.name?e?[e]:void 0:e.args.flatMap(S).filter((e=>void 0!==e))}function I(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const k=e=>{e&&e.canExecute&&!e.isExecuting&&e.execute()};class N{constructor(e){I(this,"selectionValue",void 0),I(this,"type","Single"),this.selectionValue=e}updateProps(e){this.selectionValue=e}isSelected(e){var t;return(null===(t=this.selectionValue.selection)||void 0===t?void 0:t.id)===e.id}add(e){this.selectionValue.setSelection(e)}remove(e){this.selectionValue.setSelection(void 0)}}class T{constructor(e,t){I(this,"selectionValue",void 0),I(this,"selectableItems",void 0),I(this,"type","Multi"),I(this,"rangeStart",void 0),I(this,"rangeEnd",void 0),this.selectionValue=e,this.selectableItems=t,this.rangeStart=void 0}isSelected(e){return this.selectionValue.selection.some((t=>t.id===e.id))}updateProps(e,t){this.selectionValue=e,this.selectableItems=t}get selectionStatus(){return 0===this.selectionValue.selection.length?"none":this.selectionValue.selection.length===this.selectableItems.length?"all":"some"}add(e){this._add(e),this._setRangeStart(e),this._setRangeEnd(void 0)}remove(e){this.isSelected(e)&&this.selectionValue.setSelection(this.selectionValue.selection.filter((t=>t.id!==e.id))),this._resetRange()}reduceTo(e){this.selectionValue.setSelection([e]),this._setRangeStart(e),this._setRangeEnd(void 0)}_add(e){this.isSelected(e)||this.selectionValue.setSelection(this.selectionValue.selection.concat(e))}_setRangeStart(e){let t=-1;void 0!==e&&(t=this.selectableItems.indexOf(e)),this.rangeStart=t>-1?t:void 0}_setRangeEnd(e){if(void 0===e)return void(this.rangeEnd=void 0);const t=this.rangeEnd,n=this.selectableItems.indexOf(e);this.rangeEnd=n>-1?n:void 0,this._updateSelectionWithRange(this.rangeStart,t,n)}_updateSelectionWithRange(e,t,n){if(void 0===e)return;if(-1===n)return;if(t===n)return;if(void 0===t){const t=this._getRange(e,n);return void this.selectionValue.setSelection(t)}const o=this._getRange(e,t),r=this._getRange(e,n);let i=[];i=this._diff(i,o),i=this._union(i,r),this.selectionValue.setSelection(i)}_getRange(e,t){const n=this.selectableItems.length,[o,r]=[A(e,0,n),A(t,0,n)].sort(((e,t)=>e-t));return this.selectableItems.slice(o,r+1)}_resetRange(){this._setRangeStart(void 0),this._setRangeEnd(void 0)}_union(e,t){const n=[...e],o=new Set(e.map((e=>e.id)));for(const e of t)o.has(e.id)||(o.add(e.id),n.push(e));return n}_diff(e,t){const n=new Set(e),o=new Set(t.map((e=>e.id)));for(const e of n)o.has(e.id)&&n.delete(e);return Array.from(n)}selectAll(){this.selectionValue.setSelection(this.selectableItems),this._resetRange()}selectNone(){this.selectionValue.setSelection([]),this._resetRange()}selectUpTo(e){void 0===this.rangeStart?(this._add(e),this._setRangeStart(e)):this._setRangeEnd(e)}_findIndexInList(e,t,n){const o=this.selectableItems.length-1,r="forward"===t;if("edge"===n)return r?o:0;return A(r?e+n:e-n,0,o)}_findIndexInGrid(e,t,n){const{columnIndex:o}=function(e,t,n){if(n<0||n>=t)return{columnIndex:-1,rowIndex:-1};const o=n%e,r=function(e,t){return Math.floor(e/t)}(n,e);return{columnIndex:o,rowIndex:r}}(n,this.selectableItems.length,e);return"pagedown"===t?this.selectableItems.length-(n-o):"home"===t?e-o:"end"===t?e+(n-(o+1)):o}selectUpToAdjacent(e,t,n,o,r){if(!1===t)return void this._resetRange();const i=this.selectableItems.findIndex((t=>t.id===e.id));let l=-1;l="backward"===n||"forward"===n?this._findIndexInList(i,n,o):this._findIndexInGrid(i,n,null!=r?r:0),l!==i&&(void 0===this.rangeStart&&this._setRangeStart(e),this._setRangeEnd(this.selectableItems.at(l)))}}const A=(e,t,n)=>Math.min(Math.max(e,t),n);function _(e,t,r){const i=n([]),l=n(!1);l.current||(l.current="loading"!==(null==t?void 0:t.status)),o((()=>{var t;const n=i.current,o=null!==(t=null==e?void 0:e.selection)&&void 0!==t?t:[],s=Array.isArray(o)?o:[o];(function(e,t){if(e.length!==t.length)return!1;const n=new Set(t.map((e=>e.id)));return e.every((e=>n.has(e.id)))})(n,s)||(i.current=s,l.current&&k(r))}),[null==e?void 0:e.selection,r]);const s=n(void 0);var a,c;void 0!==e&&("Single"===e.type?s.current?s.current.updateProps(e):s.current=new N(e):s.current?s.current.updateProps(e,null!==(a=t.items)&&void 0!==a?a:[]):s.current=new T(e,null!==(c=t.items)&&void 0!==c?c:[]));return s.current}const E=new Set(["KeyA","MetaLeft","MetaRight","ControlLeft","ControlRight"]),M=(e,t)=>{let n=!1;const[o,r]=function(e,t){let n=0,o=0;return[function(){for(var r=arguments.length,i=new Array(r),l=0;l<r;l++)i[l]=arguments[l];const s=(new Date).getTime()-o,a=()=>{n=0,o=(new Date).getTime(),e(...i)};n||(s>=t?a():n=window.setTimeout(a,t-s))},()=>{clearTimeout(n),n=0}]}((()=>{n=!0,e()}),500);return[{eventName:"onKeyDown",filter:(e,t)=>"Multi"===e.selectionType&&function(e){return"KeyA"===e.code&&(e.metaKey||e.ctrlKey)}(t),handler:o},{eventName:"onKeyUp",filter:(e,t)=>"Multi"===e.selectionType&&E.has(t.code)&&n,handler:()=>{n=!1,r(),null==t||t()}}]},D=e=>[{eventName:"onKeyDown",filter:(e,t)=>"ArrowUp"===t.code&&"Multi"===e.selectionType,handler:(t,n)=>{let{item:o}=t;return e(o,n.shiftKey,"backward",1)}},{eventName:"onKeyDown",filter:(e,t)=>"ArrowDown"===t.code&&"Multi"===e.selectionType,handler:(t,n)=>{let{item:o}=t;return e(o,n.shiftKey,"forward",1)}},{eventName:"onKeyDown",filter:(e,t)=>"PageUp"===t.code&&"Multi"===e.selectionType,handler:(t,n)=>{let{item:o,pageSize:r}=t;return e(o,n.shiftKey,"backward",r)}},{eventName:"onKeyDown",filter:(e,t)=>"PageDown"===t.code&&"Multi"===e.selectionType,handler:(t,n)=>{let{item:o,pageSize:r}=t;return e(o,n.shiftKey,"forward",r)}},{eventName:"onKeyDown",filter:(e,t)=>"Home"===t.code&&"Multi"===e.selectionType,handler:(t,n)=>{let{item:o}=t;return e(o,n.shiftKey,"backward","edge")}},{eventName:"onKeyDown",filter:(e,t)=>"End"===t.code&&"Multi"===e.selectionType,handler:(t,n)=>{let{item:o}=t;return e(o,n.shiftKey,"forward","edge")}}],P="com.mendix.widgets.web.selectable.selectionContext";class O{constructor(e,t){var n=this;I(this,"selection",void 0),I(this,"selectionHelper",void 0),I(this,"onSelect",(function(){n.selectionHelper&&("Multi"===n.selectionHelper.type?n._onSelectItemMulti(...arguments):n._onSelectItemSingle(...arguments))})),I(this,"_onSelectItemMulti",((e,t,n)=>{var o;"Multi"===(null===(o=this.selectionHelper)||void 0===o?void 0:o.type)&&(t?this.selectionHelper.selectUpTo(e):this.selectionHelper.isSelected(e)?this.selectionHelper.remove(e):n?this.selectionHelper.add(e):this.selectionHelper.reduceTo(e))})),I(this,"_onSelectItemSingle",(e=>{var t;"Single"===(null===(t=this.selectionHelper)||void 0===t?void 0:t.type)&&(this.selectionHelper.isSelected(e)?this.selectionHelper.remove(e):this.selectionHelper.add(e))})),I(this,"onSelectAll",(e=>{this.selectionHelper&&("Single"!==this.selectionHelper.type?"selectAll"!==e&&"all"===this.selectionHelper.selectionStatus?this.selectionHelper.selectNone():this.selectionHelper.selectAll():console.warn("Datagrid: calling onSelectAll in single selection mode have no effect"))})),I(this,"onSelectAdjacent",(function(){var e;"Multi"===(null===(e=n.selectionHelper)||void 0===e?void 0:e.type)&&n.selectionHelper.selectUpToAdjacent(...arguments)})),I(this,"isSelected",(e=>!!this.selectionHelper&&this.selectionHelper.isSelected(e))),this.selection=e,this.selectionHelper=t}get selectionType(){if(void 0===this.selection)return"None";if("object"==typeof this.selection)return this.selection.type;if("None"===this.selection||"Single"===this.selection||"Multi"===this.selection)return this.selection;throw new Error("Unknown selection type: ".concat(this.selection))}}function L(){const e="com.mendix.widgets.web.UUID";return window[e]||(window[e]=1),window[e]++}var R,H={exports:{}};
/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/R=H,function(){var e={}.hasOwnProperty;function t(){for(var n=[],o=0;o<arguments.length;o++){var r=arguments[o];if(r){var i=typeof r;if("string"===i||"number"===i)n.push(r);else if(Array.isArray(r)){if(r.length){var l=t.apply(null,r);l&&n.push(l)}}else if("object"===i){if(r.toString!==Object.prototype.toString&&!r.toString.toString().includes("[native code]")){n.push(r.toString());continue}for(var s in r)e.call(r,s)&&r[s]&&n.push(s)}}}return n.join(" ")}R.exports?(t.default=t,R.exports=t):window.classNames=t}();var z=H.exports;const F=a(l((function(e,t){let{className:n,borderTop:o,clickable:r,previewAsHidden:i,wrapText:l,alignment:a,tabIndex:c,...u}=e;return s("div",{className:z("td",{"td-borders":o,clickable:r,"hidden-column-preview":i,"wrap-text":l,["align-column-".concat(a)]:"string"==typeof a},n),role:"gridcell",tabIndex:null!=c?c:r?0:void 0,ref:t,...u})}))),K=Symbol("DefaultKeyNavContextValue"),V=e(K);function U(e){let{focusController:t,children:n}=e;const o=i((()=>({focusController:t})),[t]);return s(V.Provider,{value:o},n)}function j(e,t){return"".concat(e,",").concat(t)}function B(e){const[t,n]=e.split(",");return[parseInt(t,10),parseInt(n,10)]}function W(e){const r=n(null),l=n(e.focusTarget),{focusController:s}=function(){const e=c(V);if(e===K)throw new Error("useKeyNavContext: context provider is missing");return e}(),[a,u]=i((()=>{const t=j(e.columnIndex,e.rowIndex);return[t===s.focusTarget,t]}),[e.columnIndex,e.rowIndex,s.focusTarget]),[d,p]=t({canFocus:!1});return o((()=>{const e=e=>p((t=>e.lastPos===u?{canFocus:!1}:e.targetPos===u?{canFocus:e.shouldFocus}:t));return s.addListener(e),()=>s.removeListener(e)}),[s,u]),o((()=>{const{current:e}=l;if(d.canFocus){const t="function"==typeof e?e():r.current;null==t||t.focus()}}),[d]),{ref:r,tabIndex:a?0:-1,"data-position":u}}const Z=a((function(e){var t;const n=W({columnIndex:null!==(t=e.columnIndex)&&void 0!==t?t:-1,rowIndex:e.rowIndex}),o=i((()=>e.eventsController.getProps(e.item)),[e.item,e.eventsController]);return s(F,{alignment:e.column.alignment,borderTop:0===e.rowIndex,className:e.column.columnClass(e.item),wrapText:e.column.wrapText,clickable:e.clickable,previewAsHidden:e.preview&&(e.column.initiallyHidden||!e.column.visible),tabIndex:n.tabIndex,ref:n.ref,"data-position":n["data-position"],onClick:o.onClick,onDoubleClick:o.onDoubleClick,onMouseDown:o.onMouseDown,onKeyDown:o.onKeyDown,onKeyUp:o.onKeyUp,onFocus:o.onFocus},e.column.renderCellContent(e.item))}));function G(e){let{direction:t}=e;const n="pagination-icon ".concat(t);switch(t){case"forward":return s("span",{"aria-hidden":!0},s("svg",{className:n,viewBox:"0 0 32 32",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},s("path",{d:"M17.81 6.63C17.48 6.37 17 6.61 17 7.02V24.98C17 25.4 17.48 25.63 17.81 25.37L28.5 16.39C28.76 16.19 28.76 15.8 28.5 15.6L17.81 6.63Z",fill:"currentColor"}),s("path",{d:"M4.81 6.63C4.48 6.37 4 6.61 4 7.02V24.98C4 25.4 4.48 25.63 4.81 25.37L15.5 16.39C15.76 16.19 15.76 15.8 15.5 15.6L4.81 6.63Z",fill:"currentColor"})));case"step-forward":return s("span",{"aria-hidden":!0},s("svg",{className:n,viewBox:"0 0 32 32",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},s("path",{d:"M8.81 6.63C8.48 6.37 8 6.61 8 7.02V24.98C8 25.4 8.48 25.63 8.81 25.37L20.5 16.39C20.76 16.19 20.76 15.8 20.5 15.6L8.81 6.63Z",fill:"currentColor"}),s("path",{d:"M24 6H22V26H24V6Z",fill:"currentColor"})));case"backward":return s("span",{"aria-hidden":!0},s("svg",{className:n,viewBox:"0 0 32 32",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},s("path",{d:"M14.19 6.63L3.51 15.61C3.25 15.81 3.25 16.2 3.51 16.4L14.2 25.38C14.53 25.64 15.01 25.4 15.01 24.99V7.02C15.01 6.6 14.53 6.37 14.2 6.63H14.19Z",fill:"currentColor"}),s("path",{d:"M27.19 6.63L16.5 15.61C16.24 15.81 16.24 16.2 16.5 16.4L27.19 25.38C27.52 25.64 28 25.4 28 24.99V7.02C28 6.6 27.52 6.37 27.19 6.63Z",fill:"currentColor"})));case"step-backward":return s("span",{"aria-hidden":!0},s("svg",{className:n,viewBox:"0 0 32 32",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},s("path",{d:"M23.19 6.63L11.51 15.61C11.25 15.81 11.25 16.2 11.51 16.4L23.2 25.38C23.53 25.64 24.01 25.4 24.01 24.99V7.02C24.01 6.6 23.53 6.37 23.2 6.63H23.19Z",fill:"currentColor"}),s("path",{d:"M10 6H8V26H10V6Z",fill:"currentColor"})));default:return s("div",null)}}function X(e){var t,n,o,r,i,l,a;const c=void 0!==e.numberOfItems?Math.ceil(e.numberOfItems/e.pageSize):void 0,u=void 0!==c?c-1:0,d=void 0!==c,p=e.page*e.pageSize+1,h=e.canNextPage||!e.numberOfItems?(e.page+1)*e.pageSize:e.numberOfItems,m=t=>{e.setPaginationIndex&&e.setPaginationIndex(t)};if(0===e.numberOfItems)return null;const g="".concat(p," to ").concat(h," ").concat(d?"of ".concat(null!==(t=e.numberOfItems)&&void 0!==t?t:(null!=c?c:1)*e.pageSize):"");return s("div",{"aria-label":null!==(n=e.labelPagination)&&void 0!==n?n:"Pagination",className:"pagination-bar"},s("button",{className:"btn pagination-button",disabled:0===e.page,...q((()=>{e.gotoPage(0),m(0)})),"aria-label":null!==(o=e.labelFirstPage)&&void 0!==o?o:"Go to first page"},s(G,{direction:"step-backward"})),s("button",{className:"btn pagination-button",disabled:!e.canPreviousPage,...q((()=>{e.previousPage(),m(e.page-1)})),"aria-label":null!==(r=e.labelPreviousPage)&&void 0!==r?r:"Go to previous page"},s(G,{direction:"backward"})),s("span",{className:"sr-only sr-only-focusable"},null!==(i=e.labelPagingStatus)&&void 0!==i?i:"Currently showing"," ",g),s("div",{"aria-hidden":!0,className:"paging-status"},g),s("button",{"aria-label":null!==(l=e.labelNextPage)&&void 0!==l?l:"Go to next page",className:"btn pagination-button",disabled:!e.canNextPage,...q((()=>{e.nextPage(),m(e.page+1)}))},s(G,{direction:"forward"})),d&&s("button",{"aria-label":null!==(a=e.labelLastPage)&&void 0!==a?a:"Go to last page",className:"btn pagination-button",disabled:e.page===u,...q((()=>{e.gotoPage(u),m(u)}))},s(G,{direction:"step-forward"})))}function q(e){return{onClick:e,onKeyDown:t=>{" "!==t.key&&"Enter"!==t.key||(t.preventDefault(),t.stopPropagation(),e())}}}const J=Symbol("NO_PROPS_VALUE"),Y=e(J),Q=Y.Provider;function $(){const e=c(Y);if(e===J)throw new Error("useTableProps: failed to get value from props provider.");return e}function ee(e){let{id:t,value:r,onChange:i}=e;const l=n(null);return o((()=>{l.current&&("all"===r||"none"===r?l.current.indeterminate=!1:"some"===r&&(l.current.indeterminate=!0))}),[r]),s("input",{id:t,type:"checkbox",className:"three-state-checkbox",ref:l,checked:"none"!==r,onChange:i})}function te(){const{selectActionHelper:e,selectionStatus:t}=$(),{showCheckboxColumn:n,showSelectAllToggle:o,onSelectAll:r}=e;if(!1===n)return s(u,null);let i=null;if(o){if("unknown"===t)throw new Error("Don't know how to render checkbox with selectionStatus=unknown");i=s(ee,{value:t,onChange:r})}return s("div",{className:"th widget-datagrid-col-select",role:"columnheader"},i)}function ne(e){const t=n(e);return o((()=>{t.current=e})),r((function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return t.current&&t.current.apply(void 0,n)}),[])}function oe(e){let{minWidth:i=50,setColumnWidth:l,onResizeEnds:a,onResizeStart:c}=e;const[u,d]=t(!1),[p,h]=t(0),[m,g]=t(0),f=n(null),v=ne(c),w=r((e=>{const t=e.touches?e.touches[0].screenX:e.screenX;if(h(t),d(!0),f.current){const e=f.current.parentElement;g(e.clientWidth)}v()}),[v]),b=r((()=>{u&&(d(!1),g(0),null==a||a())}),[a,u]),y=ne(l),x=r((e=>{if(!u)return;const t=e.touches?e.touches[0].screenX:e.screenX;if(m){let e=m-(p-t);e<i&&(e=i),y(e)}}),[u,m,p,i,y]);return o((()=>(document.addEventListener("mousemove",x),document.addEventListener("mouseup",b),document.addEventListener("touchmove",x),document.addEventListener("touchend",b),()=>{document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",b),document.removeEventListener("touchmove",x),document.removeEventListener("touchend",b)})),[x,b]),s("div",{"aria-hidden":!0,ref:f,className:"column-resizer",onMouseDown:w,onTouchStart:w},s("div",{className:"column-resizer-bar"}))}function re(){return s("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"far","data-icon":"eye",className:"svg-inline--fa fa-eye fa-w-18",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16"},s("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0.589893 7.715C0.724893 7.52 3.91989 3 7.99989 3C12.0799 3 15.2749 7.52 15.4099 7.715L15.6099 8L15.4099 8.285C15.2749 8.48 12.0799 13 7.99989 13C3.91989 13 0.724893 8.48 0.589893 8.285L0.389893 8L0.589893 7.715ZM1.62489 8C2.37489 8.96 4.98989 12 7.99989 12C11.0099 12 13.6249 8.96 14.3749 8C13.6249 7.04 11.0099 4 7.99989 4C4.98989 4 2.37489 7.04 1.62489 8ZM5.5 8C5.5 6.62 6.62 5.5 8 5.5C9.38 5.5 10.5 6.62 10.5 8C10.5 9.38 9.38 10.5 8 10.5C6.62 10.5 5.5 9.38 5.5 8ZM6.5 8C6.5 8.825 7.175 9.5 8 9.5C8.825 9.5 9.5 8.825 9.5 8C9.5 7.175 8.825 6.5 8 6.5C7.175 6.5 6.5 7.175 6.5 8Z",fill:"currentColor"}))}function ie(e,t){o((()=>{const{current:n}=Array.isArray(e)?e[0]:e;if(!n)return;const o=n.ownerDocument,r=function(e,t){const n=Array.isArray(e)?e:[e];return e=>{n.every((t=>{let{current:n}=t;return n&&!n.contains(e.target)}))&&t()}}(e,t);return o.addEventListener("mousedown",r),o.addEventListener("touchstart",r),()=>{o.removeEventListener("mousedown",r),o.removeEventListener("touchstart",r)}}),[e,t])}function le(e,n){const[i,l]=t(),s=r((()=>{l((t=>{const n=null==e?void 0:e.getBoundingClientRect();return r=n,(o=t)&&r&&o.height===r.height&&o.width===r.width&&o.bottom===r.bottom&&o.top===r.top&&o.left===r.left&&o.right===r.right?t:n;var o,r}))}),[e]);var a;return o((()=>a?function(e){let t;const n=()=>{t=window.requestAnimationFrame((()=>{e(),n()}))},o=()=>window.cancelAnimationFrame(t);return n(),o}(a):void 0),[a=n?s:void 0]),i}const se=e=>{const n=e.current,[o,r]=t(!0);return d((()=>{const e=null==n?void 0:n.getBoundingClientRect(),t=!e||e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth);r(t)}),[n]),o};function ae(e){var o;const{toggleHidden:l,visibleLength:a}=e,[c,u]=t(!1),d=n(null),p=n(null),h=le(p.current,c);ie([p,d],(()=>u(!1)));const m=null!==(o=e.label)&&void 0!==o?o:"Column selector",g=se(d),f=i((()=>e.columns.findIndex((e=>e.canHide))),[e.columns]),v=i((()=>e.columns.map((e=>e.canHide)).lastIndexOf(!0)),[e.columns]),w=s("ul",{ref:d,id:"".concat(e.id,"-column-selectors"),className:"column-selectors ".concat(g?"":"overflow"),"data-focusindex":0,role:"menu",style:{position:"fixed",top:null==h?void 0:h.bottom,right:void 0!==(null==h?void 0:h.right)?document.body.clientWidth-h.right:void 0}},e.columns.map(((t,n)=>{const o=!e.hiddenColumns.has(t.columnId),r=o&&1===a,i=()=>{r||l(t.columnId)};return t.canHide?s("li",{key:t.columnNumber,onClick:e=>{e.preventDefault(),e.stopPropagation(),i()},onKeyDown:e=>{var t;"Enter"===e.key||" "===e.key?(e.preventDefault(),e.stopPropagation(),i()):("Tab"===e.key&&(n===v||e.shiftKey&&n===f)||"Escape"===e.key)&&(e.preventDefault(),u(!1),null===(t=p.current)||void 0===t||t.focus())},role:"menuitem",tabIndex:0},s("input",{checked:o,disabled:r,id:"".concat(e.id,"_checkbox_toggle_").concat(n),style:{pointerEvents:"none"},type:"checkbox",tabIndex:-1,onChange:ce}),s("label",{htmlFor:"".concat(e.id,"_checkbox_toggle_").concat(n),style:{pointerEvents:"none"}},t.header)):null}))),b=r((()=>{u((e=>!e)),setTimeout((()=>{var e,t;null===(t=null===(e=d.current)||void 0===e?void 0:e.querySelector("li"))||void 0===t||t.focus()}),10)}),[]);return s("div",{"aria-label":m,className:"th column-selector",role:"columnheader",title:m},s("div",{className:"column-selector-content"},s("button",{"aria-label":m,ref:p,className:"btn btn-default column-selector-button",onClick:b,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),e.stopPropagation(),b())},"aria-haspopup":!0,"aria-expanded":c,"aria-controls":"".concat(e.id,"-column-selectors")},s(re,null))),c&&w)}function ce(){}function ue(e){const{children:t,className:n,...o}=e;return s("div",{className:z("widget-datagrid-grid table",n),role:"grid",...o},t)}function de(e){return s("div",{...e,className:z("widget-datagrid-grid-body table-content",e.className),role:"rowgroup"})}function pe(){return s("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"long-arrow-alt-down",className:"svg-inline--fa fa-long-arrow-alt-down fa-w-8",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 512"},s("path",{fill:"currentColor",d:"M168 345.941V44c0-6.627-5.373-12-12-12h-56c-6.627 0-12 5.373-12 12v301.941H41.941c-21.382 0-32.09 25.851-16.971 40.971l86.059 86.059c9.373 9.373 24.569 9.373 33.941 0l86.059-86.059c15.119-15.119 4.411-40.971-16.971-40.971H168z"}))}function he(){return s("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"long-arrow-alt-up",className:"svg-inline--fa fa-long-arrow-alt-up fa-w-8",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 512"},s("path",{fill:"currentColor",d:"M88 166.059V468c0 6.627 5.373 12 12 12h56c6.627 0 12-5.373 12-12V166.059h46.059c21.382 0 32.09-25.851 16.971-40.971l-86.059-86.059c-9.373-9.373-24.569-9.373-33.941 0l-86.059 86.059c-15.119 15.119-4.411 40.971 16.971 40.971H88z"}))}function me(){return s("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"arrows-alt-v",className:"svg-inline--fa fa-arrows-alt-v fa-w-8",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 512"},s("path",{fill:"currentColor",d:"M214.059 377.941H168V134.059h46.059c21.382 0 32.09-25.851 16.971-40.971L144.971 7.029c-9.373-9.373-24.568-9.373-33.941 0L24.971 93.088c-15.119 15.119-4.411 40.971 16.971 40.971H88v243.882H41.941c-21.382 0-32.09 25.851-16.971 40.971l86.059 86.059c9.373 9.373 24.568 9.373 33.941 0l86.059-86.059c15.12-15.119 4.412-40.971-16.97-40.971z"}))}function ge(e){var t,n,o;const i=e.sortable&&e.column.canSort,l=e.draggable&&null!==(t=e.column.canDrag)&&void 0!==t&&t,a=function(e,t,n,o){const i=r((e=>{var t;o(!0);const n=e.target;e.dataTransfer.setData(fe,null!==(t=n.dataset.columnId)&&void 0!==t?t:"")}),[o]),l=r((e=>{e.preventDefault()}),[]),s=r((e=>{const{dataset:{columnId:t}}=e.target;t!==e.dataTransfer.getData(fe)&&n(t)}),[n]),a=r((()=>{o(!1),n(void 0)}),[n,o]),c=r((e=>{a();const n=e.target.dataset.columnId,o=e.dataTransfer.getData(fe);t([n,o])}),[a,t]);return e?{draggable:!0,onDragStart:i,onDragOver:l,onDrop:c,onDragEnter:s,onDragEnd:a}:{}}(l,e.swapColumns,e.setDragOver,e.setIsDragging),c=!!e.sortRule,u=c&&"desc"===(null===(n=e.sortRule)||void 0===n?void 0:n[1]),d=i?s(c?u?pe:he:me,null):null,p=e.column.header.trim(),h=()=>{e.setSortBy(e.column.columnId)},m={onClick:h,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),h())},role:"button",tabIndex:0};return s("div",{"aria-sort":i?c?u?"descending":"ascending":"none":void 0,className:z("th",{"hidden-column-preview":e.preview&&(e.hidable&&e.column.initiallyHidden||!e.column.visible)}),role:"columnheader",style:e.sortable&&e.column.canSort?void 0:{cursor:"unset"},title:p,ref:null===(o=e.useHeaderRef)||void 0===o?void 0:o.call(e,e.column.columnId)},s("div",{className:z("column-container",{dragging:l&&e.column.columnId===e.dragOver}),id:"".concat(e.gridId,"-column").concat(e.column.columnId),"data-column-id":e.column.columnId,...a},s("div",{className:z("column-header",i?"clickable":"",e.className),style:{pointerEvents:e.isDragging?"none":void 0},...i?m:void 0,"aria-label":i?"sort "+p:p},s("span",null,p.length>0?p:"Â "),d),e.filterable&&e.filterWidget),e.resizable&&e.column.canResize&&e.resizer)}const fe="application/x-mx-widget-web-datagrid-column-id";function ve(e){return s(F,{...e,className:"column-selector"})}function we(e){let{item:t,rowIndex:n,lastRow:o,...r}=e;const i=W({columnIndex:0,rowIndex:n}),{selectActionHelper:l,checkboxEventsController:a,selectRowLabel:c,rowClickable:u}=$();return s(F,{...r,clickable:u,className:"widget-datagrid-col-select",tabIndex:-1},s("input",{checked:l.isSelected(t),type:"checkbox",tabIndex:i.tabIndex,"data-position":i["data-position"],onChange:ye,onFocus:o?be:void 0,ref:i.ref,"aria-label":"".concat(null!=c?c:"Select row"," ").concat(n+1),...a.getProps(t)}))}function be(e){var t;"function"==typeof(null===(t=e.target.parentElement)||void 0===t?void 0:t.scrollIntoView)&&e.target.parentElement.scrollIntoView(!1)}function ye(){}function xe(e){const{CellComponent:t}=e,{selectActionHelper:n,preview:o,data:r,rowClickable:i,cellEventsController:l}=$(),a=n.isSelected(e.item),c="None"===n.selectionType?void 0:a,u=0===e.index;return s("div",{className:z("tr",{"tr-selected":a},e.className),role:"row","aria-selected":c},n.showCheckboxColumn&&s(we,{item:e.item,key:"checkbox_cell",borderTop:u,rowIndex:e.index,lastRow:e.index===r.length-1}),e.columns.map(((r,a)=>{const c=s(t,{key:"row_".concat(e.item.id,"_col_").concat(r.columnNumber),column:r,rowIndex:e.index,columnIndex:n.showCheckboxColumn?a+1:a,item:e.item,clickable:i,preview:o,eventsController:l});return o?e.selectableWrapper(a,c):c})),e.showSelectorCell&&s(ve,{key:"column_selector_cell",borderTop:u,clickable:i,tabIndex:-1}))}function Ce(e){var r,i;const[l,s]=t(!1),a=null!==(i=(r=n()).current)&&void 0!==i?i:r.current=function(e){let{setIsIntersecting:t}=e;return new IntersectionObserver((e=>{let[n]=e;t(n.isIntersecting)}))}({setIsIntersecting:s});return o((()=>(e.current&&a.observe(e.current),()=>{a.disconnect()})),[a,e]),l}const Se=30;function Ie(){const e=n(null),[r,i]=t(1);return o((()=>{const t=e.current;if(null!==t)return function(e,t){const n=new IntersectionObserver((e=>{let[n]=e;0!==n.intersectionRatio&&1!==n.intersectionRatio||t(n.intersectionRatio)}),{threshold:[0,1]});return n.observe(e),()=>n.unobserve(e)}(t,i)}),[]),s("div",{className:z("sticky-sentinel",{"container-stuck":0===r}),ref:e,style:{height:1,marginBottom:"-1px"}})}function ke(e){let{children:o,className:i,hasMoreItems:l,isInfinite:a,style:c,setPage:u}=e;const[p,h,m]=function(e){const{setPage:o,hasMoreItems:i,isInfinite:l}=e,[s,a]=t(0),c=n(null),u=Ce(c),p=r((e=>{Math.floor(e.target.scrollHeight-Se-e.target.scrollTop)<=Math.floor(e.target.clientHeight)+2&&i&&o&&o((e=>e+1))}),[i,o]),h=r((()=>{u&&l&&i&&s<=0&&c.current&&a(c.current.clientHeight-Se)}),[l,i,s,u]);return d((()=>{setTimeout((()=>h()),100)}),[h]),[p,s,c]}({hasMoreItems:l,isInfinite:a,setPage:u});return s("div",{className:z("widget-datagrid-content","sticky-table-container",{"infinite-loading":a},i),ref:m,onScroll:a?p:void 0,style:a&&h>0?{...c,maxHeight:h}:c},s(Ie,null),o)}function Ne(e){const{pagingPosition:t,pagination:n,...o}=e;return s("div",{...o,className:"widget-datagrid-footer table-footer"},("bottom"===t||"both"===t)&&n)}function Te(e){const{children:t,headerTitle:n,...o}=e;return t?s("div",{...o,className:"widget-datagrid-header header-filters","aria-label":n||void 0},t):null}function Ae(e){const{className:t,selectionMethod:n,selection:o,exporting:r,children:i,...l}=e;return s("div",{...l,className:z(t,"widget-datagrid",{"widget-datagrid-exporting":r,"widget-datagrid-selectable-rows":o,"widget-datagrid-selection-method-checkbox":o&&"checkbox"===n,"widget-datagrid-selection-method-click":o&&"rowClick"===n})},i)}function _e(e){return s("div",{...e,className:"widget-datagrid-top-bar table-header"},e.children)}function Ee(e){return s("div",{className:"widget-datagrid-modal-root",role:"presentation"},s("div",{className:"widget-datagrid-modal-overlay",role:"presentation"}),s("div",{className:"widget-datagrid-modal-main",role:"presentation"},e.children))}function Me(){return Me=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Me.apply(this,arguments)}function De(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const o=t[0];if(1===t.length)return o;const r=()=>{const e=t.map((e=>({useScope:e(),scopeName:e.scopeName})));return function(t){const n=e.reduce(((e,n)=>{let{useScope:o,scopeName:r}=n;return{...e,...o(t)["__scope".concat(r)]}}),{});return i((()=>({["__scope".concat(o.scopeName)]:n})),[n])}};return r.scopeName=o.scopeName,r}function Pe(){return Pe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Pe.apply(this,arguments)}function Oe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>t.forEach((t=>function(e,t){"function"==typeof e?e(t):null!=e&&(e.current=t)}(t,e)))}const Le=l(((e,t)=>{const{children:n,...o}=e,r=p.toArray(n),i=r.find(ze);if(i){const e=i.props.children,n=r.map((t=>t===i?p.count(e)>1?p.only(null):h(e)?e.props.children:null:t));return s(Re,Pe({},o,{ref:t}),h(e)?m(e,void 0,n):null)}return s(Re,Pe({},o,{ref:t}),n)}));Le.displayName="Slot";const Re=l(((e,t)=>{const{children:n,...o}=e;return h(n)?m(n,{...Fe(o,n.props),ref:t?Oe(t,n.ref):n.ref}):p.count(n)>1?p.only(null):null}));Re.displayName="SlotClone";const He=e=>{let{children:t}=e;return s(u,null,t)};function ze(e){return h(e)&&e.type===He}function Fe(e,t){const n={...t};for(const o in t){const r=e[o],i=t[o];/^on[A-Z]/.test(o)?r&&i?n[o]=function(){i(...arguments),r(...arguments)}:r&&(n[o]=r):"style"===o?n[o]={...r,...i}:"className"===o&&(n[o]=[r,i].filter(Boolean).join(" "))}return{...e,...n}}const Ke=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce(((e,t)=>{const n=l(((e,n)=>{const{asChild:r,...i}=e,l=r?Le:t;return o((()=>{window[Symbol.for("radix-ui")]=!0}),[]),s(l,Me({},i,{ref:n}))}));return n.displayName="Primitive.".concat(t),{...e,[t]:n}}),{}),Ve="Progress",Ue=100,[je,Be]=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=[];const r=()=>{const n=o.map((t=>e(t)));return function(e){const o=(null==e?void 0:e[t])||n;return i((()=>({["__scope".concat(t)]:{...e,[t]:o}})),[e,o])}};return r.scopeName=t,[function(n,r){const l=e(r),a=o.length;function u(e){const{scope:n,children:o,...r}=e,c=(null==n?void 0:n[t][a])||l,u=i((()=>r),Object.values(r));return s(c.Provider,{value:u},o)}return o=[...o,r],u.displayName=n+"Provider",[u,function(e,o){const i=(null==o?void 0:o[t][a])||l,s=c(i);if(s)return s;if(void 0!==r)return r;throw new Error("`".concat(e,"` must be used within `").concat(n,"`"))}]},De(r,...n)]}(Ve),[We,Ze]=je(Ve),Ge=l(((e,t)=>{const{__scopeProgress:n,value:o,max:r,getValueLabel:i=qe,...l}=e,a=Qe(r)?r:Ue,c=$e(o,a)?o:null,u=Ye(c)?i(c,a):void 0;return s(We,{scope:n,value:c,max:a},s(Ke.div,Me({"aria-valuemax":a,"aria-valuemin":0,"aria-valuenow":Ye(c)?c:void 0,"aria-valuetext":u,role:"progressbar","data-state":Je(c,a),"data-value":null!=c?c:void 0,"data-max":a},l,{ref:t})))}));Ge.propTypes={max(e,t,n){const o=e[t],r=String(o);return o&&!Qe(o)?new Error(function(e,t){return"Invalid prop `max` of value `".concat(e,"` supplied to `").concat(t,"`. Only numbers greater than 0 are valid max values. Defaulting to `").concat(Ue,"`.")}(r,n)):null},value(e,t,n){const o=e[t],r=String(o),i=Qe(e.max)?e.max:Ue;return null==o||$e(o,i)?null:new Error(function(e,t){return"Invalid prop `value` of value `".concat(e,"` supplied to `").concat(t,"`. The `value` prop must be:\n  - a positive number\n  - less than the value passed to `max` (or ").concat(Ue," if no `max` prop is set)\n  - `null` if the progress is indeterminate.\n\nDefaulting to `null`.")}(r,n))}};const Xe=l(((e,t)=>{var n;const{__scopeProgress:o,...r}=e,i=Ze("ProgressIndicator",o);return s(Ke.div,Me({"data-state":Je(i.value,i.max),"data-value":null!==(n=i.value)&&void 0!==n?n:void 0,"data-max":i.max},r,{ref:t}))}));function qe(e,t){return"".concat(Math.round(e/t*100),"%")}function Je(e,t){return null==e?"indeterminate":e===t?"complete":"loading"}function Ye(e){return"number"==typeof e}function Qe(e){return Ye(e)&&!isNaN(e)&&e>0}function $e(e,t){return Ye(e)&&!isNaN(e)&&e<=t&&e>=0}const et=Ge,tt=Xe;function nt(){return s("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true"},s("path",{d:"M14.205 3.205L12.795 1.795L8 6.585L3.205 1.795L1.795 3.205L6.585 8L1.795 12.795L3.205 14.205L8 9.415L12.795 14.205L14.205 12.795L9.415 8L14.205 3.205Z",fill:"currentColor"}))}function ot(){return s("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true"},s("rect",{x:"13.3773",y:"10.5415",width:"5.30402",height:"14.7575",fill:"white"}),s("path",{d:"M29.71 24.97L23.77 15.11L17.64 4.94C16.89 3.69 15.11 3.69 14.36 4.94L8.23002 15.11L2.29002 24.97C1.50002 26.29 2.42002 28 3.94002 28H28.06C29.58 28 30.5 26.29 29.71 24.97ZM16 25C14.9 25 14 24.1 14 23C14 22 14.74 21.18 15.7 21.03C15.8 21.01 15.9 21 16 21C16.1 21 16.21 21.01 16.3 21.03C17.26 21.18 18 22 18 23C18 24.1 17.1 25 16 25ZM18 19H14V11H18V19Z",fill:"currentColor"}))}function rt(e){let{alertLabel:n,cancelLabel:o,failed:r,onCancel:i,progress:l,total:a}=e;const[c]=t((()=>"widget-datagrid-export-alert-".concat(L())));return s("div",{id:c,className:z("widget-datagrid-export-alert",{"widget-datagrid-export-alert-failed":r}),role:"status","aria-live":"off","aria-label":n},s("button",{role:"button",className:"btn btn-image btn-icon widget-datagrid-export-alert-cancel",onClick:i,"aria-label":o,tabIndex:0},s(nt,null)),s("div",{className:"widget-datagrid-export-alert-message"},r?s(ot,null):s("p",null,lt(a)?function(e,t){return"".concat(e," / ").concat(t)}(l,a):l)),s(it,{progress:l,total:a}))}function it(e){let{progress:t,total:n}=e;const o=lt(n)&&n;return s(et,{className:"widget-datagrid-export-progress",value:o?t:null,max:n},s(tt,{className:z("widget-datagrid-export-progress-indicator",{"widget-datagrid-export-progress-indicator-indeterminate":!o}),style:o?st(t,n):void 0}))}function lt(e){return"number"==typeof e&&e>0}function st(e,t){return{transform:"translateX(-".concat(100-at(e,0,t),"%)")}}function at(e,t,n){if(e<t)return 0;if(e>n)return 100;const o=n-t,r=Math.round((e-t)/o*100);return Math.abs(r)}function ct(e){let{open:t,...n}=e;return t?s(Ee,null,s(rt,{...n})):null}function ut(e){var n,o;const{className:l,columnsDraggable:a,columnsFilterable:c,columnsHidable:u,columnsResizable:d,columnsSortable:p,data:h,emptyPlaceholderRenderer:m,exporting:g,filterRenderer:f,headerContent:v,headerTitle:w,hasMoreItems:b,headerWrapperRenderer:y,id:x,numberOfItems:C,onExportCancel:S,page:I,pageSize:k,paging:N,pagingPosition:T,preview:A,processedRows:_,setPage:E,styles:M,CellComponent:D,state:P,actions:O,selectActionHelper:L}=e,R=A?P.allColumns:P.visibleColumns,H=(u?1:0)+(L.showCheckboxColumn?1:0),F=R.length+H,K=!N,[V,j]=t(!1),[B,W]=t(void 0),Z=!!v,G=N&&("top"===T||"both"===T),q=r((e=>s("div",{className:"filter",style:{pointerEvents:V?"none":void 0}},e)),[V]),J=N?s(X,{canNextPage:b,canPreviousPage:0!==I,gotoPage:e=>E&&E((()=>e)),nextPage:()=>E&&E((e=>e+1)),numberOfItems:C,page:I,pageSize:k,previousPage:()=>E&&E((e=>e-1))}):null,Y=i((()=>function(e,t,n){const o=e.map((n=>{const o=e.at(-1)===n,r=t[n.columnId];if(r)return o?"minmax(min-content, auto)":"".concat(r,"px");switch(n.width){case"autoFit":{const e="manual"===n.minWidth?"".concat(n.minWidthLimit,"px"):"minContent"===n.minWidth?"min-content":"auto";return"minmax(".concat(e,", auto)")}case"manual":return"".concat(n.weight,"fr");default:return"1fr"}})),r=[];n.selectItemColumn&&r.push("48px");r.push(...o),n.visibilitySelectorColumn&&r.push("54px");return{gridTemplateColumns:r.join(" ")}}(R,e.state.size,{selectItemColumn:L.showCheckboxColumn,visibilitySelectorColumn:u})),[e.state.size,R,u,L.showCheckboxColumn]),$="None"!==L.selectionType;return s(Q,{value:e},s(Ae,{className:l,selectionMethod:L.selectionMethod,selection:$,style:M,exporting:g},G&&s(_e,null,J),Z&&s(Te,{headerTitle:w},v),s(ke,{isInfinite:K,hasMoreItems:b,setPage:E},s(ue,{"aria-multiselectable":$?"Multi"===L.selectionType:void 0},s(de,{style:Y},s("div",{key:"headers_row",className:"tr",role:"row"},s(te,{key:"headers_column_select_all"}),R.map(((t,n)=>y(n,s(ge,{key:"".concat(t.columnId),className:"align-column-".concat(t.alignment),gridId:e.id,column:t,draggable:a,dragOver:B,filterable:c,filterWidget:f(q,t.columnNumber),hidable:u,isDragging:V,preview:A,resizable:d&&R.at(-1)!==t,resizer:s(oe,{onResizeStart:O.createSizeSnapshot,setColumnWidth:e=>O.resize([t.columnId,e])}),swapColumns:O.swap,setDragOver:W,setIsDragging:j,setSortBy:O.sortBy,sortable:p,sortRule:P.sortOrder.find((e=>{let[n]=e;return t.columnId===n})),visibleColumns:P.visibleColumns,useHeaderRef:e.useHeaderRef})))),u&&s(ae,{key:"headers_column_selector",columns:P.availableColumns,hiddenColumns:P.hidden,id:x,toggleHidden:O.toggleHidden,visibleLength:P.visibleColumns.length})),s(U,{focusController:e.focusController},h.map(((t,n)=>{var o;return s(xe,{CellComponent:D,className:null===(o=e.rowClass)||void 0===o?void 0:o.call(e,t),columns:R,index:n,item:t,key:"row_".concat(t.id),showSelectorCell:u,preview:null!=A&&A,selectableWrapper:y})}))),(0===h.length||A)&&m&&m((e=>s("div",{key:"row-footer",className:z("td",{"td-borders":!A}),style:{gridColumn:"span ".concat(F)}},s("div",{className:"empty-placeholder"},e))))))),s(Ne,{pagination:J,pagingPosition:T}),s(ct,{alertLabel:null!==(n=e.exportDialogLabel)&&void 0!==n?n:"Export progress",cancelLabel:null!==(o=e.cancelExportLabel)&&void 0!==o?o:"Cancel data export",failed:!1,onCancel:S,open:g,progress:_,total:C})))}const dt=a((n=>{const o=(void 0===window[P]&&(window[P]=e(void 0)),window[P]),r=function(){let t=window[w];return null==t&&(t=e(void 0),window[w]=t),t}(),l=n.state,a=i((()=>n.filterList.reduce(((e,t)=>{let{filter:n}=t;return{...e,[n.id]:n}}),{})),[n.filterList]),[c]=t((()=>n.filterList.reduce(((e,t)=>{let{filter:o}=t;return{...e,[o.id]:C(o,n.viewStateFilters)}}),{})));return s(r.Provider,{value:{filterDispatcher:e=>{if(e.filterType){const[,t]=l[e.filterType];t(e),n.setFiltered(!0)}return e},multipleAttributes:a,multipleInitialFilters:c}},s(o.Provider,{value:n.selectionContextValue},n.children))}));dt.displayName="WidgetHeaderContext";const pt=dt;function ht(e){if(null==e)throw new Error(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Did not expect an argument to be undefined");return e}function mt(e){if(e.filterAssociation)return function(e){const t=e=>"Can't map ColumnsType to AssociationProperties: ".concat(e," is undefined"),n=ht(e.filterAssociation,t("filterAssociation")),o=ht(e.filterAssociationOptions,t("filterAssociationOptions")),r=ht(e.filterAssociationOptionLabel,t("filterAssociationOptionLabel"));return{association:n,optionsSource:o,getOptionLabel:e=>{var t;return null!==(t=r.get(e).value)&&void 0!==t?t:"Error: unable to get caption"}}}(e)}const gt=e=>e&&"available"===e.status&&e.value,ft="com.mendix.widgets.web.datagrid.export",vt=200,wt=Symbol("overwrite"),bt=e=>{const[t,n]=function(e){let{columns:t,items:n=[],offset:r,limit:l=vt,hasMoreItems:s,updateDataSource:a}=e;const[c,u]=g(xt,yt()),[d,p]=i(Ct,[]);return o((()=>u({type:"DataSourceUpdate",payload:{items:n,offset:r,limit:l,hasMoreItems:s}})),[n,r,l,s]),o((()=>{u({type:"ColumnsUpdate",payload:{columns:t}})}),[t]),o((()=>{d(c,u,a)}),[c]),o((()=>p),[]),[{currentLimit:c.currentLimit,exporting:c.exporting,items:c.exporting?c.snapshot.items:null!=n?n:[],processedRows:c.processedRows},u]}(e);o((()=>{window[ft]||(window[ft]={}),window.DATAGRID_DATA_EXPORT||(window.DATAGRID_DATA_EXPORT="");let t,o=!1,r=!1;const i={create(){if(r)throw new Error("Data grid (Export): export stream is busy");let o=!1;return{process:(i,l)=>{const{limit:s=vt}=null!=l?l:{},a=e=>{"aborted"!==e.type&&"end"!==e.type||(r=!1,o=!1),i(e)};n({type:"Setup",payload:{callback:a,columns:e.columns,limit:Math.min(s,500)}}),t=()=>{r&&a({type:"aborted"})},o=!0},start:()=>{if(!o)throw new Error("Data grid (Export): can't start without handler.");n({type:"Start"})},abort:()=>{n({type:"Abort"})}}},[wt]:()=>{o=!0}},l=window[ft][e.name];return l&&l[wt](),window[ft][e.name]=i,window.DATAGRID_DATA_EXPORT=ft,()=>{null==t||t(),!1===o&&delete window[ft][e.name]}}),[]);return[t,i((()=>({abort:()=>n({type:"Abort"})})),[n])]};function yt(){return{callback:null,columns:null,currentItems:[],currentLimit:Number.POSITIVE_INFINITY,currentOffset:0,exporting:!1,hasMoreItems:!0,phase:"awaitingCallback",processedRows:0,snapshot:null}}function xt(e,t){if("Reset"===t.type)return yt();if("DataSourceUpdate"===t.type){if("awaitingCallback"===e.phase&&function(e,t){let{payload:n}=t;if(e.currentLimit===n.limit&&e.currentOffset===n.offset&&e.hasMoreItems==e.hasMoreItems&&e.currentItems.length===n.items.length)return e.currentItems.every(((e,t)=>{const o=n.items[t];return e.id===o.id}));return!1}(e,t))return e;const n=e.phase,o={...e,currentOffset:t.payload.offset,currentLimit:t.payload.limit,currentItems:t.payload.items,hasMoreItems:t.payload.hasMoreItems};return o.exporting&&"awaitingData"===n&&(o.phase="exportData"),o.exporting&&"resetOffset"===n&&(0===o.currentItems.length?o.phase="finished":o.phase="exportData"),o.exporting&&"finally"===n?{...yt(),currentLimit:t.payload.limit,currentItems:t.payload.items,currentOffset:t.payload.offset}:o}if("ColumnsUpdate"===t.type&&("readyToStart"===e.phase||"exportColumns"===e.phase||"exportData"===e.phase||"awaitingCallback"===e.phase))return{...e,columns:t.payload.columns};if("Setup"===t.type&&"awaitingCallback"===e.phase)return{...e,phase:"readyToStart",snapshot:{items:e.currentItems,offset:e.currentOffset,limit:e.currentLimit},callback:t.payload.callback,columns:e.columns||t.payload.columns,currentLimit:t.payload.limit,currentOffset:0};if("Start"===t.type){if(e.exporting)return e;if("readyToStart"===e.phase&&e.callback instanceof Function)return{...e,phase:"exportColumns",exporting:!0};throw new Error("Datagrid (Export): Export start failed: invalid state.")}return"ColumnsExported"===t.type&&e.exporting&&"exportColumns"===e.phase?{...e,phase:"resetOffset"}:"PageExported"===t.type&&e.exporting&&"exportData"===e.phase?{...e,phase:"awaitingData",processedRows:e.processedRows+e.currentLimit}:"Finish"===t.type&&e.exporting?{...e,phase:"finished"}:"Abort"===t.type&&e.exporting?{...e,phase:"aborting"}:"ExportEnd"===t.type&&e.exporting?{...e,phase:"finally",processedRows:0}:e}function Ct(){let e=null;const t=()=>(null===e&&(e=new St),e),n=()=>{e=new St};return[async(e,o,r)=>{const i=t();if(!1!==e.exporting)if("resetOffset"!==e.phase){if("exportColumns"===e.phase){const{columns:t,callback:n}=e;return await i.exec((()=>n(function(e){return{type:"columns",payload:e.map((e=>{var t,n,o,r;return{name:e.header&&gt(e.header)&&null!==(n=null===(t=e.header.value)||void 0===t?void 0:t.toString())&&void 0!==n?n:"",type:null!==(r=null===(o=e.attribute)||void 0===o?void 0:o.type.toString())&&void 0!==r?r:""}}))}}(t)))),void i.exec((()=>o({type:"ColumnsExported"})))}if("exportData"!==e.phase)if("awaitingData"!==e.phase){if("aborting"===e.phase){const{callback:t}=e;return i.exec((()=>t({type:"aborted"}))),i.exec((()=>o({type:"ExportEnd"}))),void i.abort("abortAction")}if("finished"===e.phase){const{callback:t}=e;return i.exec((()=>t({type:"end"}))),void i.exec((()=>o({type:"ExportEnd"})))}if("finally"===e.phase){const{snapshot:t}=e;!1!==i.isAborted&&"abortAction"!==i.abortReason||r({offset:t.offset,limit:t.limit}),n()}}else{const{currentOffset:t,currentLimit:n,hasMoreItems:l}=e;l?i.exec((()=>r({offset:t+n}))):i.exec((()=>o({type:"Finish"})))}else{const{currentItems:t,callback:n,columns:r}=e;if(t.length>0){const e=function(e,t){let n=!1;const o=e.map((e=>t.map((t=>{var o,r,i,l,s;let a="";if("attribute"===t.showContentAs)a=null!==(i=null===(r=null===(o=t.attribute)||void 0===o?void 0:o.get(e))||void 0===r?void 0:r.displayValue)&&void 0!==i?i:"";else if("dynamicText"===t.showContentAs){const o=null===(l=t.dynamicText)||void 0===l?void 0:l.get(e);"loading"===(null==o?void 0:o.status)?n=!0:a="unavailable"===(null==o?void 0:o.status)?"n/a":null!==(s=null==o?void 0:o.value)&&void 0!==s?s:""}else a="n/a (custom content)";return a}))));return n?{status:"pending"}:{status:"ready",message:{type:"data",payload:o}}}(t,r);"ready"===e.status&&(await i.exec((()=>n(e.message))),i.exec((()=>o({type:"PageExported"}))))}}}else i.exec((()=>r({offset:0,limit:e.currentLimit,reload:!0})))},()=>{t().abort("unmount")}]}class St{constructor(){this.aborted=!1,this.reason=null}async exec(e){this.isAborted||await e()}abort(e){this.aborted=!0,this.reason=e}get isAborted(){return this.aborted}get abortReason(){return this.reason}}function It(e,t){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2166136261;const n=e.length;for(let o=0;o<n;o++)t^=e.charCodeAt(o),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return t>>>0}(JSON.stringify({name:t,columns:e.map((e=>({columnId:e.columnId,canSort:e.canSort,canHide:e.canHide,canResize:e.canResize,canDrag:e.canDrag})))})).toString()}function kt(e,t){return e.flatMap((e=>{let[n,o]=e;var r;const{attrId:i}=null!==(r=t.find((e=>e.columnId===n)))&&void 0!==r?r:{};return i?[[i,o]]:[]}))}function Nt(e,t){return e.flatMap((e=>{let[n,o]=e;var r;const i=null===(r=t.find((e=>e.attrId===n)))||void 0===r?void 0:r.columnId;return i?[[i,o]]:[]}))}function Tt(e,t){return{sortOrder:e.sortOrder,columnOrder:e.columnOrder,hidden:new Set(e.columns.flatMap((e=>e.hidden?[e.columnId]:[]))),size:Object.fromEntries(e.columns.map((e=>[e.columnId,e.size]))),filter:t.filter}}function At(e,t){return{sortOrder:Nt(t.sortOrder,e),size:{},hidden:new Set(e.flatMap((e=>e.initiallyHidden?[e.columnId]:[]))),columnOrder:e.map((e=>e.columnId)),filter:t.filter}}function _t(e,t,r){const[l,s]=g(Et,{params:e,columns:t},Lt),[a,c]=function(){const e=n(new Map),{current:t}=n((function(t){const r=n(null);return o((()=>{const n=e.current;return n.set(t,r.current),()=>{n.delete(t)}}),[t]),r})),{current:r}=n((t=>t(e.current)));return[r,t]}(),u=i((()=>{const e={resize:e=>s({type:"resize",payload:e}),setFilter:e=>s({type:"setFilter",payload:e}),sortBy:e=>s({type:"sortBy",payload:e}),swap:e=>s({type:"swap",payload:e}),toggleHidden:e=>s({type:"toggleHidden",payload:e}),setSize:e=>s({type:"setSize",payload:e}),createSizeSnapshot:()=>a((t=>e.setSize([...t.entries()].reduce(((e,t)=>{let[n,o]=t;return e[n]=o.clientWidth,e}),{}))))};return e}),[s,a]);return o((()=>s({type:"setColumns",payload:t})),[t]),function(e,t){const r=n(void 0);o((()=>{void 0!==r.current&&e(r.current,t),r.current=t}),t)}(((e,t)=>{let[n]=e,[o]=t;return r(n,o)}),[l]),[l,u,{useHeaderRef:c}]}function Et(e,t){switch(t.type){case"resize":return{...e,size:Pt(e.size,t.payload)};case"setFilter":return e.filter===t.payload?e:{...e,filter:t.payload};case"setColumns":return e.allColumns===t.payload?e:function(e,t){const n=Mt(t,e.columnOrder);let o=e.hidden,r=Dt(n,o);0===r.length&&(o=new Set,r=Dt(n,o));return{...e,allColumns:t,availableColumns:n,visibleColumns:r,hidden:o}}(e,t.payload);case"sortBy":return{...e,sortOrder:Ot(e.sortOrder,t.payload)};case"swap":{const n=function(e,t){let[n,o]=t;const r=e.indexOf(n),i=e.indexOf(o);if(-1===r||-1===i)return console.warn("Unable to find column in the current order array."),e;if(r!==i){const t=[...e];return t[r]=o,t[i]=n,t}return e}(e.columnOrder,t.payload),o=Mt(e.allColumns,n);return{...e,columnOrder:n,availableColumns:o,visibleColumns:Dt(o,e.hidden)}}case"toggleHidden":{const r=function(e,t,n){if(e.some((e=>!n.has(e.columnId))))return n;return t}(e.availableColumns,e.hidden,function(e,t){const n=new Set(e);!1===n.delete(t)&&n.add(t);return n}(e.hidden,t.payload));return e.hidden===r?e:{...e,hidden:r,sortOrder:(n=e.sortOrder,o=t.payload,n.flatMap((e=>e[0]===o?[]:[e]))),visibleColumns:Dt(e.availableColumns,r)}}case"setSize":return{...e,size:t.payload};default:return e}var n,o}function Mt(e,t){return function(e,t){const n=[...e],o=Object.fromEntries(t.map(((e,t)=>[e,t])));return n.sort(((e,t)=>o[e.columnId]-o[t.columnId])),n}(e,t).filter((e=>e.visible))}function Dt(e,t){return e.filter((e=>!t.has(e.columnId)))}function Pt(e,t){let[n,o]=t;return{...e,[n]:o}}function Ot(e,t){const[[n,o]=[]]=e;return n===t?"asc"===o?[[t,"desc"]]:[]:[[t,"asc"]]}function Lt(e){let{params:t,columns:n}=e;const o=Mt(n,t.columnOrder),r=Dt(o,t.hidden);return{allColumns:n,availableColumns:o,columnOrder:t.columnOrder,filter:t.filter,hidden:t.hidden,size:t.size,sortOrder:t.sortOrder,visibleColumns:r}}const Rt=e=>{const{pagination:t,showPagingButtons:n,totalCount:o,limit:r}=e;return i((()=>"buttons"===t&&("always"===n||"auto"===n&&!!o&&o>r)),[t,n,o,r])};class Ht{constructor(e){this.properties=e}get alignment(){return this.properties.alignment}get canSort(){return this.properties.sortable}get canResize(){return this.properties.resizable}get canDrag(){return this.properties.draggable}get canHide(){return"no"!==this.properties.hidable}get initiallyHidden(){return"hidden"===this.properties.hidable}get weight(){var e;return null!==(e=this.properties.size)&&void 0!==e?e:1}get width(){return this.properties.width}get wrapText(){return this.properties.wrapText}get minWidth(){return this.properties.minWidth}get minWidthLimit(){return this.properties.minWidthLimit}}class zt extends Ht{constructor(e,t){var n,o;super(e),this.props=e,this.columnNumber=t,this.visible=null!==(o=null===(n=e.visible)||void 0===n?void 0:n.value)&&void 0!==o&&o}columnClass(e){var t;return null===(t=this.props.columnClass)||void 0===t?void 0:t.get(e).value}get canSort(){var e;return super.canSort&&!!(null===(e=this.props.attribute)||void 0===e?void 0:e.sortable)}get columnId(){return this.columnNumber.toString()}get header(){var e,t;return null!==(t=null===(e=this.props.header)||void 0===e?void 0:e.value)&&void 0!==t?t:""}get status(){var e,t;return null!==(t=null===(e=this.props.visible)||void 0===e?void 0:e.status)&&void 0!==t?t:"loading"}get attrId(){var e;return null===(e=this.props.attribute)||void 0===e?void 0:e.id}setInitParams(){this.props.filterAssociationOptions&&this.props.filterAssociationOptions.setLimit(0)}renderCellContent(e){var t,n,o,r,i,l,a;switch(this.props.showContentAs){case"attribute":case"dynamicText":return s("span",{className:"td-text",title:null===(n=null===(t=this.props.tooltip)||void 0===t?void 0:t.get(e))||void 0===n?void 0:n.value},"attribute"===this.props.showContentAs?null===(r=null===(o=this.props.attribute)||void 0===o?void 0:o.get(e))||void 0===r?void 0:r.displayValue:null===(l=null===(i=this.props.dynamicText)||void 0===i?void 0:i.get(e))||void 0===l?void 0:l.value);case"customContent":return s(Vt,null,null===(a=this.props.content)||void 0===a?void 0:a.get(e));default:throw new Error("Unknown content type: ".concat(this.props.showContentAs))}}}const Ft=e=>{e.stopPropagation()},Kt=e=>{"Tab"!==e.code&&e.stopPropagation()};function Vt(e){return s("div",{onClick:Ft,onKeyUp:Ft,onKeyDown:Kt,className:"td-custom-content"},e.children)}class Ut{constructor(e,t){this.attr=e,this.hash=t}load(){if("string"==typeof this.attr.value&&this.attr.value.length>0){const e=JSON.parse(this.attr.value);if(e.settingsHash===this.hash)return e;this.reset()}}save(e){this.attr.setValue(JSON.stringify(e))}reset(){this.attr.setValue(void 0)}}class jt{constructor(){this.state=this.pending(),this.initialized=!1}getInitState(e,t,n,o,r){if("ready"===this.state.status)return this.state;if(this.initialized||(this.setInitParams(e,o,t,n),this.initialized=!0),"loading"===r.status||"loading"===e.status||o.some((e=>"loading"===e.status)))return this.pending();let i,l=!1;return"available"===r.status&&(i=r.settings.load(),i&&(this.setViewState(e,i,o),e.reload(),l=!0)),this.state=this.ready(e,o,i),l?this.pending():this.state}setInitParams(e,t,n,o){"buttons"===n&&e.requestTotalCount(!0),e.setLimit(o),t.forEach((e=>e.setInitParams()))}setViewState(e,t,n){t.sortOrder.length>0&&e.setSortOrder(kt(t.sortOrder,n))}ready(e,t,n){return{status:"ready",initParams:n?Tt(n,e):At(t,e)}}pending(){return{status:"pending"}}}const[Bt,Wt]=((e,t)=>{let n=null;const o=()=>{null!==n&&(clearTimeout(n),n=null)};return[function(){for(var r=arguments.length,i=new Array(r),l=0;l<r;l++)i[l]=arguments[l];o(),n=setTimeout((()=>e(...i)),t)},o]})(((e,t)=>{e.save(t)}),500);function Zt(e){let{name:t,columns:n,datasource:r,pageSize:l,pagination:s,configurationAttribute:a}=e;const c=i((()=>new jt),[]),u=i((()=>n.map(((e,t)=>new zt(e,t)))),[n]),d=i((()=>It(u,t)),[t,u]),p=function(e,t){return i((()=>"available"===(null==t?void 0:t.status)?{status:"available",settings:new Ut(t,e)}:"loading"===(null==t?void 0:t.status)?{status:"loading",settings:void 0}:{status:"unavailable",settings:void 0}),[e,t])}(d,a),h=ne(((e,n)=>{if(e.filter!==n.filter&&r.setFilter(n.filter),e.sortOrder!==n.sortOrder&&r.setSortOrder(kt(n.sortOrder,u)),"available"===p.status){const e={schemaVersion:1,settingsHash:(o={settingsHash:d,name:t,columns:n.allColumns,hidden:n.hidden,columnOrder:n.columnOrder,size:n.size,sortOrder:n.sortOrder}).settingsHash,name:o.name,sortOrder:o.sortOrder,columnOrder:o.columnOrder,columns:o.columns.map((e=>{let{columnId:t}=e;return{columnId:t,hidden:o.hidden.has(t),size:o.size[t],filterSettings:void 0}}))};Bt(p.settings,e)}var o}));return o((()=>Wt),[]),{initState:c.getInitState(r,s,l,u,p),columns:u,stateChangeFx:h}}class Gt extends O{constructor(e,t,n,o,r){super(e,t),this._selectionMethod=n,this._showSelectAllToggle=o,this.pageSize=r}get selectionMethod(){return"None"===this.selectionType?"none":this._selectionMethod}get showCheckboxColumn(){return"checkbox"===this.selectionMethod}get showSelectAllToggle(){return this._showSelectAllToggle&&"Multi"===this.selectionType}}class Xt{constructor(e,t){this.trigger=e,this.listAction=t,this.onExecuteAction=e=>{this.listAction&&"get"in this.listAction&&k(this.listAction.get(e))}}get clickTrigger(){return this.listAction?this.trigger:"none"}update(e){this.listAction=e}}function qt(e,t){const n=function(e){return e.reduce(((e,t)=>{var n,o,r,i,l,s;switch(t.eventName){case"onClick":e.onClick=null!==(n=e.onClick)&&void 0!==n?n:[],e.onClick.push(t);break;case"onDoubleClick":e.onDoubleClick=null!==(o=e.onDoubleClick)&&void 0!==o?o:[],e.onDoubleClick.push(t);break;case"onKeyDown":e.onKeyDown=null!==(r=e.onKeyDown)&&void 0!==r?r:[],e.onKeyDown.push(t);break;case"onKeyUp":e.onKeyUp=null!==(i=e.onKeyUp)&&void 0!==i?i:[],e.onKeyUp.push(t);break;case"onMouseDown":e.onMouseDown=null!==(l=e.onMouseDown)&&void 0!==l?l:[],e.onMouseDown.push(t);break;case"onFocus":e.onFocus=null!==(s=e.onFocus)&&void 0!==s?s:[],e.onFocus.push(t)}return e}),{})}(t);return{onClick(t){var o;null===(o=n.onClick)||void 0===o||o.forEach((n=>Jt(e,t,n)))},onDoubleClick(t){var o;null===(o=n.onDoubleClick)||void 0===o||o.forEach((n=>Jt(e,t,n)))},onKeyUp(t){var o;null===(o=n.onKeyUp)||void 0===o||o.forEach((n=>Jt(e,t,n)))},onKeyDown(t){var o;null===(o=n.onKeyDown)||void 0===o||o.forEach((n=>Jt(e,t,n)))},onMouseDown(t){var o;null===(o=n.onMouseDown)||void 0===o||o.forEach((n=>Jt(e,t,n)))},onFocus(t){var o;null===(o=n.onFocus)||void 0===o||o.forEach((n=>Jt(e,t,n)))}}}function Jt(e,t,n){const o=e();(!n.filter||n.filter(o,t))&&n.handler(o,t)}const Yt=e=>({eventName:"onClick",filter:(e,t)=>"single"===e.clickTrigger&&"none"===e.selectionMethod||"single"===e.clickTrigger&&"checkbox"===e.selectionMethod&&!t.metaKey&&!t.ctrlKey,handler:t=>{let{item:n}=t;return e(n)}}),Qt=e=>({eventName:"onDoubleClick",filter:(e,t)=>"none"===e.selectionMethod?"double"===e.clickTrigger:"double"===e.clickTrigger&&!t.metaKey&&!t.ctrlKey,handler:t=>{let{item:n}=t;return e(n)}}),$t=(e,t)=>"Space"===t.code&&"none"!==e.clickTrigger?!t.shiftKey||"none"===e.selectionMethod:"Enter"===t.code&&"none"!==e.clickTrigger,en=e=>{let t=!1;return[{eventName:"onKeyDown",filter:$t,handler:()=>t=!0},{eventName:"onKeyUp",filter:(e,n)=>$t(e,n)&&t,handler:n=>{let{item:o}=n;t=!1,e(o)}}]};function tn(e){return[Yt(e),Qt(e),(t=e=>{e.preventDefault(),e.stopPropagation()},{eventName:"onKeyDown",filter:(e,t)=>function(e){return"Space"===e.code&&e.target===e.currentTarget}(t),handler:(e,n)=>t(n)}),...en(e)];var t}function nn(){var e;null===(e=window.getSelection())||void 0===e||e.removeAllRanges()}function on(){document.body.style.userSelect="none"}const rn=()=>{rn.timeoutId&&clearTimeout(rn.timeoutId),rn.timeoutId=window.setTimeout((()=>{nn(),document.body.style.userSelect="",rn.timeoutId=void 0}),250)},ln=e=>({eventName:"onClick",filter:(e,t)=>"rowClick"===e.selectionMethod?"double"===e.clickTrigger?t.metaKey||t.ctrlKey:"none"===e.clickTrigger:"checkbox"===e.selectionMethod&&(t.metaKey||t.ctrlKey),handler:(t,n)=>{let{item:o,selectionMethod:r,clickTrigger:i}=t;const l="checkbox"===r||"none"===i&&(n.metaKey||n.ctrlKey);e(o,n.shiftKey,l)}}),sn=e=>({eventName:"onKeyUp",filter:(e,t)=>"none"!==e.selectionMethod&&function(e){return"Space"===e.code&&e.shiftKey}(t),handler:t=>{let{item:n,selectionMethod:o}=t;return e(n,!1,"checkbox"===o)}});const an=e=>({eventName:"onClick",handler:(t,n)=>e({type:"Mouse",reactEvent:n})}),cn=e=>({eventName:"onKeyDown",handler:(t,n)=>e({type:"Keyboard",reactEvent:n})}),un=e=>({eventName:"onFocus",handler:(t,n)=>e({type:"Focus",reactEvent:n})});function dn(e){return[an(e),cn(e),un(e)]}class pn{constructor(e,t,n,o,r,i){this.contextFactory=e,this.selectFx=t,this.selectAllFx=n,this.selectAdjacentFx=o,this.executeActionFx=r,this.focusTargetFx=i}getProps(e){var t,n,o,r;return qt((()=>this.contextFactory(e)),[...(t=this.selectFx,n=this.selectAllFx,o=this.selectAdjacentFx,[(r=nn,{eventName:"onMouseDown",filter:e=>"none"!==e.selectionMethod,handler:r}),ln(t),sn(t),M((()=>{on(),n("selectAll")}),(()=>rn())),D(o)].flat()),...tn(this.executeActionFx),...dn(this.focusTargetFx)])}}const hn=e=>({eventName:"onClick",filter:e=>"checkbox"===e.selectionMethod,handler:(t,n)=>{let{item:o}=t;return e(o,n.shiftKey,!0)}});function mn(e,t,n){return[hn(e),...D(n),...M((()=>{on(),t("selectAll")}),(()=>rn()))]}class gn{constructor(e,t,n,o,r){this.contextFactory=e,this.selectFx=t,this.selectAllFx=n,this.selectAdjacentFx=o,this.focusTargetFx=r,this.getProps=e=>qt((()=>this.contextFactory(e)),[...mn(this.selectFx,this.selectAllFx,this.selectAdjacentFx),...dn(this.focusTargetFx)])}}class fn{constructor(e,t){I(this,"_listeners",void 0),I(this,"_focusTarget",void 0),I(this,"_positionController",void 0),I(this,"_layout",void 0),I(this,"dispatch",(e=>{const t=this._positionController.dispatch(e,this._layout);void 0!==t&&t!==this._focusTarget&&("Keyboard"===e.type?this._setTargetAndFocus(t):this._setTarget(t))})),this._listeners=[],this._focusTarget=this._getInitPosition(),this._positionController=e,this._layout=t}get focusTarget(){return this._focusTarget}addListener(e){this._listeners.push(e)}removeListener(e){this._listeners.splice(this._listeners.indexOf(e),1)}updateGridLayout(e){this._layout=e,void 0===this._layout.get(B(this._focusTarget))&&this._setTarget(this._getInitPosition())}_setTarget(e){const t=this._focusTarget;this._focusTarget=e,this._emit({lastPos:t,targetPos:e,shouldFocus:!1})}_setTargetAndFocus(e){const t=this._focusTarget;this._focusTarget=e,this._emit({lastPos:t,targetPos:e,shouldFocus:!0})}_emit(e){for(const t of this._listeners)t(e)}_getInitPosition(){return j(0,0)}}class vn{constructor(e,t,n){I(this,"rows",void 0),I(this,"columns",void 0),I(this,"pageSize",void 0),I(this,"_positions",void 0),this.columns=t,this.rows=e,this.pageSize=n,this._positions=new Set;for(let n=0;n<e;n+=1)for(let e=0;e<t;e+=1)this._positions.add(j(e,n))}get(e){let[t,n]=e;const o=j(t<0?this.columns+t:t,n<0?this.rows+n:n);if(this._positions.has(o))return o}}const wn=new Set(["ArrowUp","ArrowRight","ArrowDown","ArrowLeft","PageUp","PageDown","End","Home"]);const bn={ArrowUp:function(e){let[t,n]=e;return[t,Math.max(0,n-1)]},ArrowRight:function(e){let[t,n]=e;return[t+1,n]},ArrowDown:function(e){let[t,n]=e;return[t,n+1]},ArrowLeft:function(e){let[t,n]=e;return[Math.max(0,t-1),n]},PageUp:(e,t)=>function(e,t){let[n,o]=e;return[n,Math.max(0,o-t)]}(e,t.pageSize),PageDown:(e,t)=>function(e,t,n){let[o,r]=e;return[o,Math.min(n-1,r+t)]}(e,t.pageSize,t.rows),End:(e,t,n)=>{let{ctrlKey:o}=n;return o?[-1,-1]:function(e){let[t,n]=e;return[-1,n]}(e)},Home:(e,t,n)=>{let{ctrlKey:o}=n;return o?[0,0]:function(e){let[t,n]=e;return[0,n]}(e)}};class yn{dispatch(e,t){return"Focus"===e.type?this._handleFocusEvent(e.reactEvent):"Mouse"===e.type?this._handleMouseEvent(e.reactEvent):this._handleKeyboardEvent(e.reactEvent,t)}_handleKeyboardEvent(e,t){if(n=e.code,!wn.has(n))return;var n;if(!Object.hasOwn(bn,e.code))throw new Error("Keyboard nav: can't find handler for ".concat(e.code," key"));e.preventDefault();const o=B(this._getTargetPosition(e));return t.get(bn[e.code](o,t,e))}_handleMouseEvent(e){return this._getTargetPosition(e)}_handleFocusEvent(e){return this._getTargetPosition(e)}_getTargetPosition(e){var t;const n=null===(t=e.currentTarget.dataset)||void 0===t?void 0:t.position;if(void 0===n)throw new Error("Keyboard navigation: target position is missing");return n}}function xn(e){var l,a,c,u,d;const p="virtualScrolling"===e.pagination,h=p?e.datasource.limit/e.pageSize:e.datasource.offset/e.pageSize,m=n(void 0),[g,w]=t(!1),y={[v.STRING]:t(),[v.NUMBER]:t(),[v.DATE]:t(),[v.ENUMERATION]:t(),[v.ASSOCIATION]:t()},{FilterContext:x}=b(),[S,I,{useHeaderRef:k}]=_t(e.initParams,e.mappedColumns,e.onStateChange),[{items:N,exporting:T,processedRows:A},{abort:E}]=bt({columns:i((()=>S.visibleColumns.map((t=>e.columns[t.columnNumber]))),[S.visibleColumns,e.columns]),hasMoreItems:e.datasource.hasMoreItems||!1,items:e.datasource.items,name:e.name,offset:e.datasource.offset,limit:e.datasource.limit,updateDataSource:r((t=>{let{offset:n,limit:o,reload:r}=t;var i,l;null!=n&&(null===(i=e.datasource)||void 0===i||i.setOffset(n)),null!=o&&(null===(l=e.datasource)||void 0===l||l.setLimit(o)),r&&e.datasource.reload()}),[e.datasource])});o((()=>{!e.datasource.filter||g||m.current||(m.current=e.datasource.filter)}),[e.datasource,g]),o((()=>{e.refreshInterval>0&&setTimeout((()=>{e.datasource.reload()}),1e3*e.refreshInterval)}),[e.datasource,e.refreshInterval]);const M=r((t=>{const n=t(h);p?e.datasource.setLimit(n*e.pageSize):e.datasource.setOffset(n*e.pageSize)}),[e.datasource,e.pageSize,p,h]),D=e.columns.map((()=>t())),P=D.map((e=>{let[t]=e;return t})),O=Object.keys(y).map((e=>y[e][0])),R=i((()=>D.map((e=>{let[t]=e;var n;return null===(n=null==t?void 0:t.getFilterCondition)||void 0===n?void 0:n.call(t)})).filter((e=>void 0!==e)).concat(Object.keys(y).map((e=>{var t;return null===(t=y[e][0])||void 0===t?void 0:t.getFilterCondition()})).filter((e=>void 0!==e)))),[...P,...O]);o((()=>{R.length>0?I.setFilter(R.length>1?f(...R):R[0]):g?I.setFilter(void 0):I.setFilter(m.current)}),[R,g,I]);const H=_(e.itemSelection,e.datasource,e.onSelectionChange),z=function(e,t){return i((()=>{var n;return new Gt(e.itemSelection,t,e.itemSelectionMethod,e.showSelectAllToggle,null!==(n=e.pageSize)&&void 0!==n?n:5)}),[t])}({itemSelection:e.itemSelection,itemSelectionMethod:e.itemSelectionMethod,showSelectAllToggle:e.showSelectAllToggle,pageSize:e.pageSize},H),F=function(e){const t=i((()=>new Xt(e.onClickTrigger,e.onClick)),[]);return o((()=>{t.update(e.onClick)})),t}({onClickTrigger:e.onClickTrigger,onClick:e.onClick}),K=z.showCheckboxColumn?S.visibleColumns.length+1:S.visibleColumns.length,V=function(e){let{rows:t,columns:o,pageSize:r}=e;const l=n(null);return i((()=>{const e=new vn(t,o,r);return null===l.current?l.current=new fn(new yn,e):l.current.updateGridLayout(e),l.current}),[t,o,r])}({rows:N.length,columns:K,pageSize:e.pageSize}),U=function(e,t,n){return i((()=>new pn((n=>({item:n,pageSize:e.pageSize,selectionType:e.selectionType,selectionMethod:e.selectionMethod,clickTrigger:t.clickTrigger})),e.onSelect,e.onSelectAll,e.onSelectAdjacent,t.onExecuteAction,n.dispatch)),[e,t,n])}(z,F,V),j=function(e,t){return i((()=>new gn((t=>({item:t,pageSize:e.pageSize,selectionType:e.selectionType,selectionMethod:e.selectionMethod})),e.onSelect,e.onSelectAll,e.onSelectAdjacent,t.dispatch)),[e,t])}(z,V),B=function(e){const t=r((()=>{"Multi"===(null==e?void 0:e.type)&&("all"===e.selectionStatus?e.selectNone():e.selectAll())}),[e]),n="Multi"===(null==e?void 0:e.type)?e.selectionStatus:void 0;return i((()=>{if(void 0!==n)return{status:n,toggle:t}}),[n,t])}(H);return s(ut,{className:e.class,CellComponent:Z,columnsDraggable:e.columnsDraggable,columnsFilterable:e.columnsFilterable,columnsHidable:e.columnsHidable,columnsResizable:e.columnsResizable,columnsSortable:e.columnsSortable,data:N,emptyPlaceholderRenderer:r((t=>"custom"===e.showEmptyPlaceholder?t(e.emptyPlaceholder):s("div",null)),[e.emptyPlaceholder,e.showEmptyPlaceholder]),filterRenderer:r(((t,n)=>{const o=e.columns[n],{attribute:r,filter:i}=o,l=mt(o),[,a]=D[n],c=C(r,m.current);return t(r||l?s(x.Provider,{value:{filterDispatcher:e=>(w(!0),a(e),e),singleAttribute:r,singleInitialFilter:c,associationProperties:l}},i):i)}),[x,D,e.columns]),headerTitle:null===(l=e.filterSectionTitle)||void 0===l?void 0:l.value,headerContent:e.filtersPlaceholder&&s(pt,{filterList:e.filterList,setFiltered:w,viewStateFilters:m.current,selectionContextValue:B,state:y},e.filtersPlaceholder),hasMoreItems:null!==(a=e.datasource.hasMoreItems)&&void 0!==a&&a,headerWrapperRenderer:r(((e,t)=>t),[]),id:i((()=>"DataGrid".concat(L())),[]),numberOfItems:e.datasource.totalCount,onExportCancel:E,page:h,pageSize:e.pageSize,paging:Rt({pagination:e.pagination,showPagingButtons:e.showPagingButtons,totalCount:e.datasource.totalCount,limit:e.datasource.limit}),pagingPosition:e.pagingPosition,rowClass:r((t=>{var n,o,r;return null!==(r=null===(o=null===(n=e.rowClass)||void 0===n?void 0:n.get(t))||void 0===o?void 0:o.value)&&void 0!==r?r:""}),[e.rowClass]),rowClickable:!(!e.itemSelection&&!e.onClick),setPage:M,styles:e.style,valueForSort:r(((t,n)=>{const o=e.columns[n];return o.attribute?o.attribute.get(t).value:""}),[e.columns]),selectionStatus:"Multi"===(null==H?void 0:H.type)?H.selectionStatus:"unknown",exporting:T,processedRows:A,exportDialogLabel:null===(c=e.exportDialogLabel)||void 0===c?void 0:c.value,cancelExportLabel:null===(u=e.cancelExportLabel)||void 0===u?void 0:u.value,selectRowLabel:null===(d=e.selectRowLabel)||void 0===d?void 0:d.value,state:S,actions:I,selectActionHelper:z,cellEventsController:U,checkboxEventsController:j,focusController:V,useHeaderRef:k})}function Cn(e){const{initState:t,columns:n,stateChangeFx:o}=Zt(e);return"pending"===t.status?null:s(xn,{...e,initParams:t.initParams,mappedColumns:n,onStateChange:o})}export{Cn as default};
